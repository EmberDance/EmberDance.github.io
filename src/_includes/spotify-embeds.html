<div class="spotify-wrapper" style="max-width:600px; margin:auto;">
  <h2 style="text-align:center;margin-bottom:1em;">Featured Spotify Playlists</h2>
  <div id="spotify-embeds" style="
    max-height: 500px;
    overflow-y: auto;
    padding: 20px;
    border: 1px solid #eee;
    border-radius: 12px;
    background: #fafafa;
    /* Customize scrollbar */
    scrollbar-width: thin;
    scrollbar-color: #888 #f1f1f1;
  ">
  </div>
</div>

<style>
/* For Webkit browsers (Chrome, Safari) */
#spotify-embeds::-webkit-scrollbar {
  width: 8px;
}

#spotify-embeds::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 4px;
}

#spotify-embeds::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 4px;
}

#spotify-embeds::-webkit-scrollbar-thumb:hover {
  background: #555;
}
</style>

<script>
async function loadSpotifyEmbeds() {
  // Replace with your published Google Sheet CSV URL
  const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQKDiWJGqFDTH_J3oKsgnTFLaF8ay_VzPYHztsfi14c6YsdUYe1ZUm87d0DYkUarIE2XwP9_CWgOpOn/pub?gid=885683206&single=true&output=csv';
  const response = await fetch(sheetUrl);
  const csv = await response.text();
  const lines = csv.trim().split('\n');
  // Assumes first row is a header: Date,SpotifyLink
  const rows = lines.slice(1).map(line => {
    // Handles CSV with commas in fields
    const match = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
    return match ? match.map(cell => cell.replace(/^"|"$/g, '').trim()) : [];
  });

  const container = document.getElementById('spotify-embeds');
  rows.forEach(([date, link]) => {
    // Only process if link looks like a Spotify playlist
    const match = link && link.match(/playlist\/([a-zA-Z0-9]+)/);
    if (!match) return;
    const playlistId = match[1];
    // Format date (optional: customize as needed)
    const dateStr = date ? `<div style="font-size:0.9em;color:#666;margin-bottom:0.5em;">${date}</div>` : '';
    const embed = `
      <div style="margin-bottom:2em;padding:1em;border:1px solid #eee;border-radius:12px;background:#fafafa;">
        ${dateStr}
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/${playlistId}" width="100%" height="152" frameborder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture"></iframe>
      </div>
    `;
    container.insertAdjacentHTML('beforeend', embed);
  });
}
loadSpotifyEmbeds();
</script>