<div id="class-offerings"></div>
<script>
// Replace with your actual Google Sheet ID and GID
const SHEET_ID = 'YOUR_SHEET_ID_HERE';
const GID = '0'; // Usually 0 for the first sheet

// Build the CSV export URL
const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&gid=${GID}`;

function createTable(data) {
    const table = document.createElement('div');
    table.className = 'class-offerings-table';
    table.innerHTML = `
        <div class="table-header">
            <span>Class Name</span>
            <span>Date</span>
            <span>Teacher</span>
            <span>Description</span>
        </div>
        ${data.map(row => `
            <div class="table-row">
                <span>${row[0]}</span>
                <span>${row[1]}</span>
                <span>${row[2]}</span>
                <span>${row[3]}</span>
            </div>
        `).join('')}
    `;
    return table;
}

fetch(SHEET_URL)
    .then(response => response.text())
    .then(csv => {
        const rows = csv.trim().split('\n').map(line => line.split(','));
        // Remove header row
        const data = rows.slice(1);
        document.getElementById('class-offerings').appendChild(createTable(data));
    })
    .catch(err => {
        document.getElementById('class-offerings').textContent = 'Failed to load class offerings.';
    });
</script>
<style>
.class-offerings-table {
    border: 1px solid #ccc;
    border-radius: 8px;
    max-width: 600px;
    margin: 1em auto;
    font-family: sans-serif;
    background: #fafafa;
    box-shadow: 0 2px 8px #0001;
}
.class-offerings-table .table-header,
.class-offerings-table .table-row {
    display: grid;
    grid-template-columns: 1.5fr 1fr 1fr 2fr;
    gap: 0.5em;
    padding: 0.5em 1em;
}
.class-offerings-table .table-header {
    font-weight: bold;
    background: #f0f0f0;
    border-bottom: 1px solid #ddd;
}
.class-offerings-table .table-row:nth-child(even) {
    background: #f9f9f9;
}
</style>